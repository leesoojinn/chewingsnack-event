<!DOCTYPE html>
<html lang="ko">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8" />
  <title>ğŸ’ì¸„ì‰ìŠ¤ë‚µ í”„ë¦¬ë¯¸ì—„ ì´ë²¤íŠ¸ ëŒë¦¼íŒğŸ’</title>
  <style>
    body {
      font-family: 'Nanum Gothic', sans-serif;
      max-width: 480px;
      margin: 0 auto;
      padding: 15px;
      background: #fdfaf3; /* ì•„ì´ë³´ë¦¬í†¤ ë°°ê²½ */
      color: #5b4636; /* ë¸Œë¼ìš´ í…ìŠ¤íŠ¸ */
      text-align: center;
    }
    h2 {
      text-align: center;
      margin-bottom: 25px;
      color: #b57f50; /* ë¡œì¦ˆê³¨ë“œ íƒ€ì´í‹€ */
    }
    label, input, button {
      font-size: 1rem;
    }
    input[type=number] {
      padding: 6px 8px;
      width: 120px;
      border: 1px solid #d6c2a5;
      border-radius: 4px;
      margin-right: 10px;
      background: #fff;
    }
    button {
      padding: 7px 14px;
      background: #b57f50; /* ë¡œì¦ˆê³¨ë“œ ë²„íŠ¼ */
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s ease;
    }
    button:hover:not(:disabled) {
      background: #a06b42;
    }
    button:disabled {
      background: #d2b79b;
      cursor: not-allowed;
    }
    #wheelContainer {
      margin: 20px auto;
      position: relative;
      width: 300px;
      height: 300px;
      border-radius: 50%;
      overflow: visible;
      box-shadow: 0 0 15px #c0a97a66;
      user-select: none;
      display: flex;
      justify-content: center;
      align-items: center;
      background: radial-gradient(circle at center, #fffaf0 0%, #f7efe1 100%);
    }
    #wheel {
      width: 100%;
      height: 100%;
      transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
      transform-origin: 50% 50%;
    }
    #spinPointer {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-top: 30px solid #b8860b; /* ê³¨ë“œìƒ‰ í¬ì¸í„° */
      z-index: 10;
      filter: drop-shadow(0 2px 2px rgba(0,0,0,0.15));
      user-select: none;
      pointer-events: none;
    }
    #resultPanel {
      margin: 20px auto;
      background: #fff9ef;
      padding: 10px;
      border-radius: 8px;
      width: 90%;
      box-shadow: inset 0 0 6px #d1b97a66;
      color: #5b4636;
    }
    #history {
      margin-top: 10px;
      max-height: 120px;
      overflow-y: auto;
      font-size: 0.9rem;
      line-height: 1.4;
      color: #7a6a54;
    }
    #tierInfo {
      margin-top: 8px;
      color: #b57f50;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h2>ğŸ’ì¸„ì‰ìŠ¤ë‚µ í”„ë¦¬ë¯¸ì—„ ì´ë²¤íŠ¸ ëŒë¦¼íŒğŸ’</h2>

<div>
  <label for="purchaseAmount">êµ¬ë§¤ê¸ˆì•¡(ì›): </label>
  <input type="number" id="purchaseAmount" placeholder="ì˜ˆ: 45000" min="0" />
  <button id="applyAmount">ì ìš©</button>
  <div id="tierInfo"></div>
</div>

<div id="wheelContainer">
  <div id="wheel"></div>
  <div id="spinPointer"></div>
</div>

<button id="spinBtn" disabled>íšŒì „íŒ ëŒë¦¬ê¸°</button>

<div id="resultPanel">
  <div><strong>ë§ˆì§€ë§‰ ë‹¹ì²¨ ê²°ê³¼: </strong><span id="lastResult">-</span></div>
  <div><strong>ë‚¨ì€ íšŸìˆ˜: </strong><span id="spinsLeft">0</span></div>
  <div id="history"><strong>íˆìŠ¤í† ë¦¬:</strong><br/></div>
</div>

<script>
  const prizes = [
    "+0g ì˜¤íŠ¸ë°€ê°•ì •", "+0g ê³ êµ¬ë§ˆ ì ¤ë¦¬", "+0g ë°”ì‚­íŒŒì¹©",
    "+0g ì˜¤íŠ¸ë¦¬ì–¼ì¹©", "+0g ë™ê·¸ë¦¬ ì ¤ë¦¬", "+0g ê³ êµ¬ë§ˆì¹©",
    "+0g ê³ êµ¬ë§ˆë§ë­ì´", "+0g ë¿”ë§ˆì¹©", "+0g íë¹… ì ¤ë¦¬",
    "+0g ì°¸ë§ˆê¹¨ìŠ¤í‹±", "+0g í˜¸ë‘í’ˆì€ëŒ€ì¶”", "+0g ëª¨ì–‘ ì ¤ë¦¬",
    "+0g ê³ êµ¬ë§ˆìŠ¤í‹±", "+0g ë¿”ë§ˆì¹©", "+0g ì‚¬ê° ì ¤ë¦¬"
  ];

  const wheel = document.getElementById('wheel');
  const spinBtn = document.getElementById('spinBtn');
  const lastResultSpan = document.getElementById('lastResult');
  const spinsLeftSpan = document.getElementById('spinsLeft');
  const historyDiv = document.getElementById('history');
  const tierInfoDiv = document.getElementById('tierInfo');
  const purchaseAmountInput = document.getElementById('purchaseAmount');
  const applyAmountBtn = document.getElementById('applyAmount');

  let spinsLeft = 0;
  let currentRotation = 0;

  function drawWheel() {
    const numSegments = prizes.length;
    const canvasSize = 300;
    const center = canvasSize / 2;
    const canvas = document.createElement('canvas');
    canvas.width = canvasSize;
    canvas.height = canvasSize;

    const ctx = canvas.getContext('2d');
    const anglePerSegment = (2 * Math.PI) / numSegments;

    // ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ê³¨ë“œ & ë„¤ì´ë¹„ í†¤
    const colors = [
      '#d4af37', '#c0a97a', '#a67c52', '#8b6f47',
      '#2c3e50', '#34495e', '#b8860b', '#e0c097'
    ];

    for (let i = 0; i < numSegments; i++) {
      ctx.beginPath();
      ctx.moveTo(center, center);
      ctx.arc(center, center, center - 2, i * anglePerSegment, (i + 1) * anglePerSegment);
      ctx.closePath();

      ctx.fillStyle = colors[i % colors.length];
      ctx.fill();

      ctx.save();
      ctx.translate(center, center);
      ctx.rotate(anglePerSegment * i + anglePerSegment / 2);
      ctx.textAlign = "right";
      ctx.fillStyle = "#fffdf5"; // ë°ì€ ì•„ì´ë³´ë¦¬ ê¸€ì”¨
      ctx.font = "bold 16px Nanum Gothic, sans-serif";
      ctx.fillText(prizes[i], center - 12, 6);
      ctx.restore();
    }
    wheel.innerHTML = '';
    wheel.appendChild(canvas);
  }

  function degreeToSegment(degree) {
    const adjustedDegree = (degree + 90) % 360;
    const segmentAngle = 360 / prizes.length;
    const index = Math.floor(adjustedDegree / segmentAngle);
    return (prizes.length - 1 - index);
  }

  function spinWheel() {
    if (spinsLeft <= 0) {
      alert("ë” ì´ìƒ ëŒë¦´ ìˆ˜ ìˆëŠ” íšŸìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤!");
      return;
    }
    spinBtn.disabled = true;

    const extraRotation = 360 * (5 + Math.random() * 3);
    currentRotation += extraRotation;

    wheel.style.transition = 'transform 4s cubic-bezier(0.33, 1, 0.68, 1)';
    wheel.style.transform = `rotate(${currentRotation}deg)`;

    setTimeout(() => {
      spinBtn.disabled = false;
      spinsLeft--;
      spinsLeftSpan.textContent = spinsLeft;

      const normDegree = currentRotation % 360;
      const prizeIndex = degreeToSegment(normDegree);
      const result = prizes[prizeIndex];
      lastResultSpan.textContent = result;

      const now = new Date();
      const timeStr = now.toLocaleTimeString();
      const newRecord = document.createElement('div');
      newRecord.textContent = `${timeStr} - ${result}`;
      historyDiv.appendChild(newRecord);
    }, 4000);
  }

  function determineSpins(amount) {
    if (amount >= 70000) return 3;
    if (amount >= 50000) return 2;
    if (amount >= 30000) return 1;
    return 0;
  }

  applyAmountBtn.addEventListener('click', () => {
    const amount = Number(purchaseAmountInput.value);
    spinsLeft = determineSpins(amount);
    spinsLeftSpan.textContent = spinsLeft;

    if (spinsLeft > 0) {
      tierInfoDiv.textContent = `êµ¬ë§¤ê¸ˆì•¡ ${amount.toLocaleString()}ì› - ${spinsLeft}íšŒ ë½‘ê¸° ê¸°íšŒê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤!`;
      spinBtn.disabled = false;
    } else {
      tierInfoDiv.textContent = `ë½‘ê¸° ì°¸ì—¬ ì¡°ê±´(3ë§Œì› ì´ìƒ)ì„ ì¶©ì¡±í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.`;
      spinBtn.disabled = true;
    }
    lastResultSpan.textContent = '-';
    historyDiv.innerHTML = '<strong>íˆìŠ¤í† ë¦¬:</strong><br/>';
  });

  spinBtn.addEventListener('click', spinWheel);
  drawWheel();
</script>

</body>
</html>
